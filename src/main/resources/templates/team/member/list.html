<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<th:block th:replace="~{layout/head :: head}"></th:block>

<style>
    .container { max-width: 900px; margin: 0 auto; }
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 20px 0;
        gap: 12px;
    }
    .title-wrap { display: flex; flex-direction: column; gap: 4px; }
    .subtitle { color: #666; font-size: 0.95rem; }

    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 12px; border-bottom: 1px solid #ddd; text-align: left; }
    tr:hover { background-color: #f5f5f5; }

    .btn {
        padding: 8px 14px;
        border-radius: 6px;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        border: 1px solid transparent;
        cursor: pointer;
    }
    .btn-primary { background: #222; color: #fff; }
    .btn-secondary { background: #fff; color: #111; border-color: #ddd; }

    .paging {
        display: flex;
        gap: 8px;
        align-items: center;
        justify-content: center;
        margin: 18px 0 30px;
        flex-wrap: wrap;
    }
    .page-link {
        padding: 6px 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
        text-decoration: none;
        color: #111;
    }
    .page-link.disabled {
        pointer-events: none;
        color: #aaa;
        background: #f5f5f5;
    }
    .page-link.active {
        background: #222;
        color: #fff;
        border-color: #222;
    }
</style>

<body>
<th:block th:replace="~{layout/header :: header}"></th:block>

<div class="container">
    <div class="header">
        <div class="title-wrap">
            <h1>Team Members</h1>
            <div class="subtitle" th:text="|Team: ${team.name} (ID: ${team.id})|"></div>
        </div>

        <div style="display:flex; gap:10px;">
            <a class="btn btn-secondary" th:href="@{/team/{id}(id=${team.id})}">Team Detail</a>
            <a class="btn btn-primary" th:href="@{/team/member/create(teamId=${team.id})}">+ Add Member</a>
        </div>
    </div>

    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Role</th>
            <th style="width:140px;">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:if="${members.totalElements == 0}">
            <td colspan="3">No members found.</td>
        </tr>

        <tr th:each="m : ${members.content}">
            <td th:text="${m.id}"></td>
            <td>
                <a th:href="@{/team-member/{id}(id=${m.id})}"
                   th:text="${m.name}"
                   style="text-decoration:none; color:#111; font-weight:700;"></a>
            </td>
            <td th:text="${m.role}"></td>
            <td>
                <a class="btn btn-secondary"
                   th:href="@{/team-member/{id}(id=${m.id})}">
                    Detail
                </a>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- paging (teamId 유지) -->
    <div class="paging" th:if="${members.totalPages > 1}">
        <a class="page-link"
           th:classappend="${members.first} ? 'disabled' : ''"
           th:href="@{/member/list(teamId=${team.id}, page=${members.number - 1}, size=${members.size}, sort='id,desc')}">
            Prev
        </a>

        <a class="page-link"
           th:each="p : ${#numbers.sequence(0, members.totalPages - 1)}"
           th:text="${p + 1}"
           th:classappend="${p == members.number} ? 'active' : ''"
           th:href="@{/team/member/list(teamId=${team.id}, page=${p}, size=${members.size}, sort='id,desc')}">
        </a>

        <a class="page-link"
           th:classappend="${members.last} ? 'disabled' : ''"
           th:href="@{/team/member/list(teamId=${team.id}, page=${members.number + 1}, size=${members.size}, sort='id,desc')}">
            Next
        </a>
    </div>
</div>

<th:block th:replace="~{layout/footer :: footer}"></th:block>
</body>
</html>
